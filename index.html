<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Σύστημα Προσφορών Φωτοβολταϊκών</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Times New Roman', serif; background-color: #f5f5f5; color: #333; }
        .container { display: flex; min-height: 100vh; }
        .document-area { flex: 1; padding: 20px; max-width: calc(100% - 320px); }
        .control-panel {
            width: 300px; position: fixed; right: 10px; top: 10px; background: white;
            border: 1px solid #ddd; border-radius: 8px; padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); height: calc(100vh - 20px);
            overflow-y: auto; z-index: 1000;
        }
        .quotation-document {
            background: white; padding: 40px; margin: 0 auto; max-width: 210mm;
            min-height: 297mm; box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .page-break { page-break-before: always; margin-top: 40px; padding-top: 40px; }
        .header { text-align: center; border-bottom: 3px solid #2c5282; padding-bottom: 20px; margin-bottom: 30px; }
        .company-name { font-size: 28px; font-weight: bold; color: #2c5282; margin-bottom: 5px; }
        .company-tagline { font-size: 14px; color: #666; font-style: italic; }
        .quote-title { font-size: 24px; font-weight: bold; text-align: center; margin: 30px 0; color: #2c5282; }
        .customer-info { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        .info-section { border: 1px solid #ddd; padding: 15px; border-radius: 4px; }
        .info-section h3 { font-size: 16px; margin-bottom: 10px; color: #2c5282; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .system-overview { margin: 30px 0; padding: 20px; background: #f8f9fa; border-left: 4px solid #2c5282; }
        .pricing-table { width: 100%; border-collapse: collapse; margin: 20px 0; border: 1px solid #ddd; }
        .pricing-table th, .pricing-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .pricing-table th { background: #2c5282; color: white; font-weight: bold; }
        .pricing-table tr:nth-child(even) { background: #f8f9fa; }
        .total-row { background: #e8f4f8 !important; font-weight: bold; }
        .control-group { margin-bottom: 20px; }
        .control-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; font-size: 14px; }
        .control-group input, .control-group select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .generate-btn {
            width: 100%; background: #2c5282; color: white; border: none; padding: 12px;
            border-radius: 4px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 20px;
        }
        .generate-btn:hover { background: #1a365d; }
        .financial-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .metric-card { padding: 15px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }
        .metric-value { font-size: 24px; font-weight: bold; color: #2c5282; }
        .metric-label { font-size: 12px; color: #666; margin-top: 5px; }
        .terms-section { margin-top: 30px; }
        .terms-section h3 { color: #2c5282; margin-bottom: 15px; font-size: 18px; }
        .terms-section ul { list-style-type: disc; margin-left: 20px; }
        .terms-section li { margin-bottom: 8px; line-height: 1.5; }
        .environmental-section { background: #e8f5e8; padding: 20px; border-radius: 4px; margin: 20px 0; }
        @media print {
            .control-panel { display: none !important; }
            .document-area { max-width: 100% !important; padding: 0 !important; margin: 0 !important; }
            .quotation-document { box-shadow: none !important; margin: 0 !important; padding: 15mm !important; max-width: none !important; width: 100% !important; }
            .page-break { page-break-before: always !important; margin-top: 0 !important; padding-top: 20px !important; }
            body { background: white !important; font-size: 12pt !important; line-height: 1.4 !important; }
            .container { display: block !important; }
        }
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .control-panel { position: relative; width: 100%; height: auto; order: 1; }
            .document-area { max-width: 100%; order: 2; }
            .customer-info, .financial-metrics { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <script>
        // Force page reload and ensure all functions are properly loaded
        console.log("Solar Quotation System - Greek Version Loaded");
        
        const panels = {
            'JKM435N-54HL4R-V': { power: 435, efficiency: 21.77, width: 1.134, height: 1.762, maxVoltage: 32.59, maxCurrent: 13.35, price: 95 },
            'Longi LR5-54HPB-410M': { power: 410, efficiency: 21.0, width: 1.134, height: 1.722, maxVoltage: 31.25, maxCurrent: 13.12, price: 105 }
        };

        const inverters = {
            'EM5500-48L': { power: 5500, voltage: 48, mpptMin: 120, mpptMax: 500, price: 499 },
            'EM3500-24L': { power: 3500, voltage: 24, mpptMin: 30, mpptMax: 160, price: 339 }
        };

        function updateBatteryOptions() {
            const inverterType = document.getElementById('inverter-type').value;
            const batterySelect = document.getElementById('battery-capacity');
            
            if (inverterType === 'EM5500-48L') {
                batterySelect.innerHTML = `
                    <option value="15.5">15,5 kWh (16 στοιχεία, 48V)</option>
                    <option value="31.0">31,0 kWh (32 στοιχεία, 48V)</option>
                    <option value="46.5">46,5 kWh (48 στοιχεία, 48V)</option>
                `;
            } else {
                batterySelect.innerHTML = `
                    <option value="7.75">7,75 kWh (8 στοιχεία, 24V)</option>
                    <option value="15.5">15,5 kWh (16 στοιχεία, 24V)</option>
                    <option value="23.25">23,25 kWh (24 στοιχεία, 24V)</option>
                `;
            }
            updateAll();
        }

        function updateAll() {
            const panelType = document.getElementById('panel-type').value;
            const seriesCount = parseInt(document.getElementById('panels-series').value) || 1;
            const parallelCount = parseInt(document.getElementById('strings-parallel').value) || 1;
            const inverterType = document.getElementById('inverter-type').value;
            const batteryCapacity = parseFloat(document.getElementById('battery-capacity').value) || 15.5;
            const customerName = document.getElementById('customer-name').value;
            const customerAddress = document.getElementById('customer-address').value;

            const panel = panels[panelType];
            const inverter = inverters[inverterType];

            const totalPanels = seriesCount * parallelCount;
            const totalCapacity = (totalPanels * panel.power) / 1000;
            const systemVoltage = seriesCount * panel.maxVoltage;
            const systemCurrent = parallelCount * panel.maxCurrent;

            const panelArea = panel.width * panel.height;
            const totalArea = totalPanels * panelArea;
            const annualProduction = Math.round(totalArea * 4.9 * 365 * (panel.efficiency / 100));

            const panelCost = totalPanels * panel.price;
            const panelBaseCost = totalPanels * 50;
            const inverterCost = inverter.price;
            
            let batteryCells = inverterType === 'EM5500-48L' ? 
                Math.round((batteryCapacity / 15.5) * 16) : 
                Math.round((batteryCapacity / 7.75) * 8);
            const batteryCost = batteryCells * 110 + 150;

            const laborHours = Math.max(15, Math.min(25, 15 + (totalPanels - 3) * 1.2));
            const laborCost = Math.round(laborHours * 10);
            const totalCost = panelCost + panelBaseCost + inverterCost + batteryCost + laborCost;

            const annualSavings = Math.round(annualProduction * 0.21);
            const paybackPeriod = (totalCost / annualSavings).toFixed(1);
            const lifetimeSavings = Math.round((annualSavings * 25) - totalCost);
            const roiPercentage = ((annualSavings / totalCost) * 100).toFixed(1);

            const annualCO2Reduction = (annualProduction * 0.5 / 1000).toFixed(2);
            const treeEquivalent = Math.round(annualCO2Reduction * 23);

            document.getElementById('display-customer-name').textContent = customerName;
            document.getElementById('display-customer-address').textContent = customerAddress;
            document.getElementById('total-capacity').textContent = totalCapacity.toFixed(2) + ' kW';
            document.getElementById('panel-type-display').textContent = panelType;
            document.getElementById('total-panels').textContent = totalPanels;
            document.getElementById('inverter-display').textContent = inverterType;
            document.getElementById('battery-display').textContent = batteryCapacity + ' kWh';
            document.getElementById('series-count').textContent = seriesCount;
            document.getElementById('parallel-count').textContent = parallelCount;
            document.getElementById('system-voltage').textContent = systemVoltage.toFixed(0) + 'V';
            document.getElementById('system-current').textContent = systemCurrent.toFixed(2) + 'A';
            document.getElementById('annual-production').textContent = annualProduction.toLocaleString() + ' kWh';

            document.getElementById('pricing-table-body').innerHTML = `
                <tr><td>Φωτοβολταϊκά Πάνελ</td><td>${panelType} (${panel.power}W έκαστο)</td><td>${totalPanels}</td><td>€${panel.price}</td><td>€${panelCost}</td></tr>
                <tr><td>Βάσεις & Στήριξη Πάνελ</td><td>Υλικά στήριξης και βάσεις</td><td>${totalPanels}</td><td>€50</td><td>€${panelBaseCost}</td></tr>
                <tr><td>Μετατροπέας</td><td>${inverterType} (${inverter.power}W, ${inverter.voltage}V)</td><td>1</td><td>€${inverter.price}</td><td>€${inverterCost}</td></tr>
                <tr><td>Σύστημα Μπαταριών</td><td>${batteryCapacity} kWh (${batteryCells} στοιχεία + BMS)</td><td>1</td><td>€${batteryCost}</td><td>€${batteryCost}</td></tr>
                <tr><td>Εργασίες Εγκατάστασης</td><td>Επαγγελματική εγκατάσταση (${laborHours.toFixed(1)} ώρες)</td><td>1</td><td>€${laborCost}</td><td>€${laborCost}</td></tr>
                <tr class="total-row"><td colspan="4"><strong>ΣΥΝΟΛΙΚΟ ΚΟΣΤΟΣ ΣΥΣΤΗΜΑΤΟΣ</strong></td><td><strong>€${totalCost}</strong></td></tr>
            `;

            document.getElementById('panel-specs').innerHTML = `
                <p><strong>Μοντέλο:</strong> ${panelType}</p>
                <p><strong>Ισχύς Εξόδου:</strong> ${panel.power}W ανά πάνελ</p>
                <p><strong>Απόδοση:</strong> ${panel.efficiency}%</p>
                <p><strong>Διαστάσεις:</strong> ${panel.width}m × ${panel.height}m</p>
                <p><strong>Μέγιστη Τάση Ισχύος:</strong> ${panel.maxVoltage}V</p>
                <p><strong>Μέγιστο Ρεύμα Ισχύος:</strong> ${panel.maxCurrent}A</p>
            `;

            document.getElementById('inverter-specs').innerHTML = `
                <p><strong>Μοντέλο:</strong> ${inverterType}</p>
                <p><strong>Ισχύς Εξόδου:</strong> ${inverter.power}W</p>
                <p><strong>Τάση Συστήματος:</strong> ${inverter.voltage}V</p>
                <p><strong>Εύρος MPPT:</strong> ${inverter.mpptMin}-${inverter.mpptMax}V</p>
            `;

            document.getElementById('payback-period').textContent = paybackPeriod;
            document.getElementById('annual-savings').textContent = '€' + annualSavings.toLocaleString();
            document.getElementById('lifetime-savings').textContent = '€' + lifetimeSavings.toLocaleString();
            document.getElementById('roi-percentage').textContent = roiPercentage + '%';
            document.getElementById('co2-reduction').textContent = annualCO2Reduction;
            document.getElementById('tree-equivalent').textContent = treeEquivalent;
            document.getElementById('lifetime-co2').textContent = (annualCO2Reduction * 25).toFixed(1);
            document.getElementById('lifetime-trees').textContent = Math.round(treeEquivalent * 25);
            document.getElementById('labor-hours').textContent = laborHours.toFixed(1);

            document.getElementById('summary-panels').textContent = totalPanels;
            document.getElementById('summary-capacity').textContent = totalCapacity.toFixed(2) + ' kW';
            document.getElementById('summary-cost').textContent = '€' + totalCost.toLocaleString();

            updateMonthlyProduction(totalArea, panel.efficiency);
        }

        function updateMonthlyProduction(totalArea, efficiency) {
            const monthlyIrradiance = [2.5, 3.3, 4.7, 6.1, 7.1, 7.9, 7.9, 7.0, 5.6, 4.0, 2.7, 2.2];
            const monthNames = ['Ιαν', 'Φεβ', 'Μάρ', 'Απρ', 'Μάι', 'Ιούν', 'Ιούλ', 'Αύγ', 'Σεπ', 'Οκτ', 'Νοε', 'Δεκ'];
            const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            
            const monthlyTableBody = document.getElementById('monthly-production');
            if (!monthlyTableBody) return;
            
            let html = '';
            monthlyIrradiance.forEach((irradiance, index) => {
                const monthlyProduction = Math.round(totalArea * irradiance * daysInMonth[index] * (efficiency / 100));
                html += `
                    <tr>
                        <td>${monthNames[index]}</td>
                        <td>${irradiance}</td>
                        <td>${monthlyProduction}</td>
                    </tr>
                `;
            });
            monthlyTableBody.innerHTML = html;
        }

        function generatePDF() {
            const btn = document.querySelector('.generate-btn');
            const originalText = btn.textContent;
            
            try {
                btn.textContent = 'Άνοιγμα Διαλόγου Εκτύπωσης...';
                btn.style.background = '#28a745';
                
                if (window.print) {
                    window.print();
                } else {
                    alert('Η λειτουργία εκτύπωσης δεν είναι διαθέσιμη. Παρακαλώ χρησιμοποιήστε Ctrl+P (Windows) ή Cmd+P (Mac) για εκτύπωση.');
                }
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#2c5282';
                }, 1500);
                
            } catch (error) {
                console.error('Σφάλμα εκτύπωσης:', error);
                alert('Αδυναμία ανοίγματος διαλόγου εκτύπωσης. Παρακαλώ χρησιμοποιήστε Ctrl+P (Windows) ή Cmd+P (Mac) για εκτύπωση.');
                btn.textContent = originalText;
                btn.style.background = '#2c5282';
            }
        }

        function updateEnergyAnalysis() {
            // This function can be called when house size changes
            // Currently just a placeholder for future enhancements
        }

        function calculateEnergyNeeds() {
            const houseSqm = parseInt(document.getElementById('house-sqm').value) || 120;
            
            // Kalamata climate data (°C)
            const climate = [
                {name: "Ιαν", days: 31, high: 15.2, low: 5.6},
                {name: "Φεβ", days: 28, high: 15.6, low: 5.8},
                {name: "Μάρ", days: 31, high: 17.3, low: 6.8},
                {name: "Απρ", days: 30, high: 20.1, low: 9.0},
                {name: "Μάι", days: 31, high: 24.4, low: 12.4},
                {name: "Ιούν", days: 30, high: 28.8, low: 15.9},
                {name: "Ιούλ", days: 31, high: 31.2, low: 18.2},
                {name: "Αύγ", days: 31, high: 31.2, low: 18.3},
                {name: "Σεπ", days: 30, high: 28.8, low: 16.2},
                {name: "Οκτ", days: 31, high: 24.6, low: 13.1},
                {name: "Νοε", days: 30, high: 20.5, low: 9.8},
                {name: "Δεκ", days: 31, high: 16.7, low: 7.2}
            ];

            // Heat pump specs - AWH-M120/5R1
            const heatPump = {
                nominalHeatingPower: 0.75, // kW at optimal conditions
                nominalCoolingPower: 0.85, // kW at optimal conditions
                maxPower: 12.0, // kW maximum draw
                optimalTempRange: [18, 25] // °C - optimal efficiency range
            };

            const comfortTemp = 21; // Target indoor temperature
            const baseLoadPerSqm = 40; // W/m² base thermal load for perfectly insulated house
            
            const monthlyData = climate.map(month => {
                const avgTemp = (month.high + month.low) / 2;
                const maxTemp = month.high;
                const minTemp = month.low;
                const tempDiff = Math.abs(avgTemp - comfortTemp);
                
                let mode, baseEfficiency, powerMultiplier, actualPower, efficiency;
                let calculationSteps = [];
                
                if (avgTemp < comfortTemp) {
                    // HEATING MODE
                    mode = 'heating';
                    
                    // Step 1: Calculate efficiency degradation in cold weather
                    if (minTemp < 0) {
                        baseEfficiency = 2.8; // COP drops significantly below 0°C
                        powerMultiplier = 2.5; // Need much more power in extreme cold
                    } else if (minTemp < 5) {
                        baseEfficiency = 3.2; // Reduced COP in cold weather
                        powerMultiplier = 2.0; // More power needed
                    } else if (minTemp < 10) {
                        baseEfficiency = 3.8; // Slightly reduced COP
                        powerMultiplier = 1.5; // Moderate increase in power
                    } else {
                        baseEfficiency = 4.5; // Optimal COP
                        powerMultiplier = 1.0; // Normal power
                    }
                    
                    actualPower = Math.min(heatPump.nominalHeatingPower * powerMultiplier, heatPump.maxPower);
                    efficiency = baseEfficiency;
                    
                    calculationSteps.push(`🔥 ΘΕΡΜΑΝΣΗ - Μέσος ${avgTemp.toFixed(1)}°C, Ελάχιστος ${minTemp.toFixed(1)}°C`);
                    calculationSteps.push(`• Συντελεστής COP: ${efficiency} (μειωμένος λόγω κρύου)`);
                    calculationSteps.push(`• Ισχύς αντλίας: ${actualPower.toFixed(2)} kW (x${powerMultiplier} λόγω συνθηκών)`);
                    
                } else {
                    // COOLING MODE
                    mode = 'cooling';
                    
                    // Step 1: Calculate efficiency degradation in hot weather
                    if (maxTemp > 38) {
                        baseEfficiency = 2.5; // EER drops significantly above 38°C
                        powerMultiplier = 3.0; // Much more power needed in extreme heat
                    } else if (maxTemp > 35) {
                        baseEfficiency = 2.8; // Reduced EER in hot weather
                        powerMultiplier = 2.2; // More power needed
                    } else if (maxTemp > 30) {
                        baseEfficiency = 3.2; // Slightly reduced EER
                        powerMultiplier = 1.6; // Moderate increase
                    } else {
                        baseEfficiency = 3.8; // Optimal EER
                        powerMultiplier = 1.0; // Normal power
                    }
                    
                    actualPower = Math.min(heatPump.nominalCoolingPower * powerMultiplier, heatPump.maxPower);
                    efficiency = baseEfficiency;
                    
                    calculationSteps.push(`❄️ ΨΥΞΗ - Μέσος ${avgTemp.toFixed(1)}°C, Μέγιστος ${maxTemp.toFixed(1)}°C`);
                    calculationSteps.push(`• Συντελεστής EER: ${efficiency} (μειωμένος λόγω ζέστης)`);
                    calculationSteps.push(`• Ισχύς αντλίας: ${actualPower.toFixed(2)} kW (x${powerMultiplier} λόγω συνθηκών)`);
                }
                
                // Step 2: Calculate thermal load based on temperature difference
                const thermalLoadPerSqm = baseLoadPerSqm + (tempDiff * 15); // Extra 15W/m² per degree difference
                const totalThermalLoad = (thermalLoadPerSqm * houseSqm) / 1000; // Convert to kW
                
                calculationSteps.push(`• Θερμικό φορτίο: ${thermalLoadPerSqm.toFixed(0)} W/m² × ${houseSqm} m² = ${totalThermalLoad.toFixed(2)} kW`);
                
                // Step 3: Calculate operating hours (heat pump runs to meet thermal load)
                const maxDailyHours = 24;
                const requiredHours = Math.min(maxDailyHours, (totalThermalLoad / actualPower) * 24);
                const actualDailyHours = Math.min(maxDailyHours, requiredHours * 1.2); // 20% safety margin
                
                calculationSteps.push(`• Απαιτούμενες ώρες: ${requiredHours.toFixed(1)}h, Πραγματικές: ${actualDailyHours.toFixed(1)}h/ημέρα`);
                
                // Step 4: Calculate energy consumption
                const dailyElectricalConsumption = (actualPower * actualDailyHours) / efficiency; // kWh per day
                const monthlyElectricalConsumption = dailyElectricalConsumption * month.days;
                
                calculationSteps.push(`• Ημερήσια κατανάλωση: ${actualPower.toFixed(2)} kW × ${actualDailyHours.toFixed(1)}h ÷ ${efficiency} = ${dailyElectricalConsumption.toFixed(2)} kWh`);
                calculationSteps.push(`• Μηνιαία κατανάλωση: ${dailyElectricalConsumption.toFixed(2)} × ${month.days} = ${monthlyElectricalConsumption.toFixed(0)} kWh`);
                
                return {
                    month: month.name,
                    avgTemp: avgTemp.toFixed(1),
                    maxTemp: maxTemp.toFixed(1),
                    minTemp: minTemp.toFixed(1),
                    mode: mode,
                    actualPower: actualPower.toFixed(2),
                    efficiency: efficiency.toFixed(1),
                    dailyHours: actualDailyHours.toFixed(1),
                    monthlyConsumption: monthlyElectricalConsumption.toFixed(0),
                    dailyConsumption: dailyElectricalConsumption.toFixed(2),
                    thermalLoad: totalThermalLoad.toFixed(2),
                    calculationSteps: calculationSteps
                };
            });

            return monthlyData;
        }

        function calculateEnergyBalance() {
            const energyNeeds = calculateEnergyNeeds();
            
            // Get current solar system data
            const panelType = document.getElementById('panel-type').value;
            const seriesCount = parseInt(document.getElementById('panels-series').value) || 1;
            const parallelCount = parseInt(document.getElementById('strings-parallel').value) || 1;
            const batteryCapacity = parseFloat(document.getElementById('battery-capacity').value) || 15.5;
            
            const panel = panels[panelType];
            const totalPanels = seriesCount * parallelCount;
            const panelArea = panel.width * panel.height;
            const totalArea = totalPanels * panelArea;
            
            // Monthly solar production
            const monthlyIrradiance = [2.5, 3.3, 4.7, 6.1, 7.1, 7.9, 7.9, 7.0, 5.6, 4.0, 2.7, 2.2];
            const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            
            const balanceData = energyNeeds.map((need, index) => {
                const monthlyProduction = Math.round(totalArea * monthlyIrradiance[index] * daysInMonth[index] * (panel.efficiency / 100));
                const consumption = parseInt(need.monthlyConsumption);
                
                // Simple energy balance calculation
                const directFromSolar = Math.min(consumption * 0.7, monthlyProduction * 0.6); // 60% during day
                const fromBattery = Math.min(consumption * 0.2, batteryCapacity * 20); // Battery cycling
                const fromGrid = Math.max(0, consumption - directFromSolar - fromBattery);
                const excessToGrid = Math.max(0, monthlyProduction - directFromSolar - (fromBattery * 1.2));
                
                return {
                    month: need.month,
                    production: monthlyProduction,
                    consumption: consumption,
                    directSolar: Math.round(directFromSolar),
                    battery: Math.round(fromBattery),
                    grid: Math.round(fromGrid),
                    excess: Math.round(excessToGrid),
                    mode: need.mode,
                    avgTemp: need.avgTemp
                };
            });
            
            return balanceData;
        }

        function showEnergyPlot() {
            // Force recalculation to avoid any caching issues
            const balanceData = calculateEnergyBalance();
            const houseSqm = document.getElementById('house-sqm').value;
            
            // Debug log to console to verify calculations
            console.log("=== DEBUG: Energy Balance Data ===");
            balanceData.forEach(month => {
                console.log(`${month.month}: Prod=${month.production}, Cons=${month.consumption}, Grid=${month.grid}%`);
            });
            
            // Create modal overlay
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            // Create modal content
            const content = document.createElement('div');
            content.style.cssText = `
                background: white; border-radius: 12px; max-width: 1200px; width: 100%; 
                max-height: 90vh; overflow-y: auto; position: relative;
            `;
            
            content.innerHTML = `
                <div style="padding: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #2c5282; padding-bottom: 15px;">
                        <h2 style="color: #2c5282; margin: 0;">📊 Ανάλυση Ενεργειακών Αναγκών</h2>
                        <button onclick="this.closest('div').parentElement.parentElement.remove()" 
                                style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; font-size: 16px; cursor: pointer;">✖</button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 25px;">
                        <h4 style="color: #2c5282; margin-bottom: 10px;">Παράμετροι Ανάλυσης</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div><strong>Σπίτι:</strong> ${houseSqm} m² (τέλεια μονωμένο)</div>
                            <div><strong>Αντλία Θερμότητας:</strong> AWH-M120/5R1</div>
                            <div><strong>Λειτουργία:</strong> 24/7 αυτόματη</div>
                            <div><strong>Στόχος:</strong> 21°C όλο το χρόνο</div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 30px;">
                        <div>
                            <h4 style="color: #2c5282; margin-bottom: 15px;">🌡️ Κλιματικές Συνθήκες & Λειτουργία</h4>
                            <div style="background: linear-gradient(45deg, #e3f2fd, #fff3e0); padding: 15px; border-radius: 8px; height: 300px; overflow-y: auto;">
                                <table style="width: 100%; font-size: 11px;">
                                    <thead>
                                        <tr style="background: rgba(44,82,130,0.1);">
                                            <th style="padding: 6px; text-align: left;">Μήνας</th>
                                            <th style="padding: 6px;">Min/Max °C</th>
                                            <th style="padding: 6px;">Λειτουργία</th>
                                            <th style="padding: 6px;">Ισχύς kW</th>
                                            <th style="padding: 6px;">Απόδοση</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${balanceData.map((data, index) => {
                                            const energyData = calculateEnergyNeeds()[index];
                                            return `
                                                <tr style="cursor: pointer;" onclick="showCalculationDetails('${data.month}', ${index})">
                                                    <td style="padding: 4px; font-weight: bold;">${data.month}</td>
                                                    <td style="padding: 4px; text-align: center; font-size: 10px;">
                                                        ${energyData.minTemp}° / ${energyData.maxTemp}°
                                                    </td>
                                                    <td style="padding: 4px; text-align: center;">
                                                        <span style="background: ${data.mode === 'heating' ? '#ff6b6b' : '#4ecdc4'}; color: white; padding: 2px 6px; border-radius: 8px; font-size: 9px;">
                                                            ${data.mode === 'heating' ? '🔥' : '❄️'}
                                                        </span>
                                                    </td>
                                                    <td style="padding: 4px; text-align: center; font-weight: bold; color: ${parseFloat(energyData.actualPower) > 2 ? '#dc3545' : '#28a745'};">
                                                        ${energyData.actualPower}
                                                    </td>
                                                    <td style="padding: 4px; text-align: center;">${energyData.efficiency}</td>
                                                </tr>
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                                <div style="margin-top: 10px; font-size: 10px; color: #666; text-align: center;">
                                    💡 Κάντε κλικ σε οποιονδήποτε μήνα για λεπτομερείς υπολογισμούς
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: #2c5282; margin-bottom: 15px;">⚡ Ενεργειακό Ισοζύγιο</h4>
                            <div style="background: linear-gradient(45deg, #f3e5f5, #e8f5e8); padding: 15px; border-radius: 8px; height: 300px; overflow-y: auto;">
                                <table style="width: 100%; font-size: 11px;">
                                    <thead>
                                        <tr style="background: rgba(44,82,130,0.1);">
                                            <th style="padding: 6px;">Μήνας</th>
                                            <th style="padding: 6px;">Παραγωγή</th>
                                            <th style="padding: 6px;">Κατανάλωση</th>
                                            <th style="padding: 6px;">Ισοζύγιο</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${balanceData.map(data => {
                                            const balance = data.production - data.consumption;
                                            const balanceColor = balance > 0 ? '#28a745' : balance > -100 ? '#ffc107' : '#dc3545';
                                            return `
                                                <tr>
                                                    <td style="padding: 4px; font-weight: bold;">${data.month}</td>
                                                    <td style="padding: 4px; text-align: center; color: #28a745;">${data.production}</td>
                                                    <td style="padding: 4px; text-align: center; color: #dc3545;">${data.consumption}</td>
                                                    <td style="padding: 4px; text-align: center; color: ${balanceColor}; font-weight: bold;">
                                                        ${balance > 0 ? '+' : ''}${balance}
                                                    </td>
                                                </tr>
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <h4 style="color: #2c5282; margin-bottom: 15px;">🔋 Ανάλυση Κάλυψης Ενεργειακών Αναγκών</h4>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <thead>
                                <tr style="background: #2c5282; color: white;">
                                    <th style="padding: 12px; border: 1px solid #ddd;">Μήνας</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Συνολική Ανάγκη (kWh)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">🌞 Άμεσα από Ηλιακά</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">🔋 Από Μπαταρίες</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">🔌 Από Δίκτυο</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">📤 Πλεόνασμα στο Δίκτυο</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${balanceData.map((data, index) => `
                                    <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">${data.month}</td>
                                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${data.consumption}</td>
                                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #ff9800;">
                                            ${data.directSolar} <span style="font-size: 11px;">(${Math.round(data.directSolar/data.consumption*100)}%)</span>
                                        </td>
                                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #4caf50;">
                                            ${data.battery} <span style="font-size: 11px;">(${Math.round(data.battery/data.consumption*100)}%)</span>
                                            <div style="font-size: 9px; color: #666;">${data.batteryStatus || ''}</div>
                                        </td>
                                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: ${data.grid > 0 ? '#f44336' : '#28a745'};">
                                            ${data.grid > 0 ? data.grid : '0'} <span style="font-size: 11px;">(${Math.round(data.grid/data.consumption*100)}%)</span>
                                        </td>
                                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #2196f3;">
                                            ${data.excess > 0 ? data.excess : '-'}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div style="margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
                        <h4 style="margin-bottom: 15px;">📊 Ετήσια Σύνοψη</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            ${(() => {
                                const totalConsumption = balanceData.reduce((sum, d) => sum + d.consumption, 0);
                                const totalDirectSolar = balanceData.reduce((sum, d) => sum + d.directSolar, 0);
                                const totalBattery = balanceData.reduce((sum, d) => sum + d.battery, 0);
                                const totalGrid = balanceData.reduce((sum, d) => sum + d.grid, 0);
                                const totalExcess = balanceData.reduce((sum, d) => sum + d.excess, 0);
                                const solarCoverage = Math.round((totalDirectSolar + totalBattery) / totalConsumption * 100);
                                
                                return `
                                    <div style="text-align: center;">
                                        <div style="font-size: 24px; font-weight: bold;">${totalConsumption.toLocaleString()}</div>
                                        <div style="font-size: 12px; opacity: 0.9;">Συνολική Κατανάλωση (kWh)</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 24px; font-weight: bold; color: #ffd700;">${solarCoverage}%</div>
                                        <div style="font-size: 12px; opacity: 0.9;">Κάλυψη από Ηλιακά</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 24px; font-weight: bold; color: #90ee90;">${totalExcess.toLocaleString()}</div>
                                        <div style="font-size: 12px; opacity: 0.9;">Πλεόνασμα στο Δίκτυο (kWh)</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 24px; font-weight: bold; color: #ffb6c1;">€${Math.round(totalGrid * 0.21).toLocaleString()}</div>
                                        <div style="font-size: 12px; opacity: 0.9;">Ετήσιο Κόστος Δικτύου</div>
                                    </div>
                                `;
                            })()}
                        </div>
                    </div>
                </div>
            `;
            
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Close on background click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // Add function to show detailed calculation steps
        function showCalculationDetails(monthName, monthIndex) {
            const energyData = calculateEnergyNeeds()[monthIndex];
            
            // Create calculation detail modal
            const detailModal = document.createElement('div');
            detailModal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.9); z-index: 15000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            const detailContent = document.createElement('div');
            detailContent.style.cssText = `
                background: white; border-radius: 12px; max-width: 800px; width: 100%; 
                max-height: 90vh; overflow-y: auto; position: relative;
            `;
            
            detailContent.innerHTML = `
                <div style="padding: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #2c5282; padding-bottom: 10px;">
                        <h3 style="color: #2c5282; margin: 0;">🔍 Λεπτομερείς Υπολογισμοί - ${monthName}</h3>
                        <button onclick="this.closest('div').parentElement.parentElement.remove()" 
                                style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; font-size: 16px; cursor: pointer;">✖</button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="color: #2c5282; margin-bottom: 10px;">📊 Βασικά Δεδομένα</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 14px;">
                            <div><strong>Μέσα Θερμοκρασία:</strong> ${energyData.avgTemp}°C</div>
                            <div><strong>Ελάχιστη:</strong> ${energyData.minTemp}°C</div>
                            <div><strong>Μέγιστη:</strong> ${energyData.maxTemp}°C</div>
                            <div><strong>Λειτουργία:</strong> ${energyData.mode === 'heating' ? '🔥 Θέρμανση' : '❄️ Ψύξη'}</div>
                        </div>
                    </div>

                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="color: #856404; margin-bottom: 15px;">⚙️ Βήμα-προς-Βήμα Υπολογισμοί</h4>
                        <div style="font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.6;">
                            ${energyData.calculationSteps.map(step => `
                                <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 4px; border-left: 3px solid #ffc107;">
                                    ${step}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; color: white;">
                        <h4 style="margin-bottom: 15px;">📈 Τελικά Αποτελέσματα</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; text-align: center;">
                            <div>
                                <div style="font-size: 20px; font-weight: bold;">${energyData.dailyConsumption}</div>
                                <div style="font-size: 12px; opacity: 0.9;">kWh/ημέρα</div>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: bold;">${energyData.monthlyConsumption}</div>
                                <div style="font-size: 12px; opacity: 0.9;">kWh/μήνα</div>
                            </div>
                            <div>
                                <div style="font-size: 20px; font-weight: bold;">€${Math.round(energyData.monthlyConsumption * 0.21)}</div>
                                <div style="font-size: 12px; opacity: 0.9;">Κόστος/μήνα</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px; padding: 15px; background: #d1ecf1; border-radius: 8px; font-size: 13px; color: #0c5460;">
                        <strong>💡 Σημείωση:</strong> Οι υπολογισμοί λαμβάνουν υπόψη τη μείωση της απόδοσης της αντλίας θερμότητας σε ακραίες θερμοκρασίες. 
                        Σε πολύ κρύο καιρό (κάτω από 5°C) ή πολύ ζεστό (πάνω από 35°C), η αντλία χρειάζεται περισσότερη ισχύ και έχει μειωμένη απόδοση.
                    </div>
                </div>
            `;
            
            detailModal.appendChild(detailContent);
            document.body.appendChild(detailModal);
            
            // Close on background click
            detailModal.addEventListener('click', (e) => {
                if (e.target === detailModal) {
                    detailModal.remove();
                }
            });
        }
    </script>

    <div class="container">
        <div class="document-area">
            <div class="quotation-document">
                <div class="header">
                    <div class="company-name">ΗΛΙΟΣ ΦΩΤΟΒΟΛΤΑΪΚΕΣ ΛΥΣΕΙΣ</div>
                    <div class="company-tagline">Τροφοδοτώντας το Μέλλον σας με Καθαρή Ενέργεια</div>
                </div>

                <div class="quote-title">ΠΡΟΣΦΟΡΑ ΦΩΤΟΒΟΛΤΑΪΚΟΥ ΣΥΣΤΗΜΑΤΟΣ</div>

                <div class="customer-info">
                    <div class="info-section">
                        <h3>Στοιχεία Πελάτη</h3>
                        <p><strong>Όνομα:</strong> <span id="display-customer-name">Ιωάννης Παπαδόπουλος</span></p>
                        <p><strong>Διεύθυνση:</strong> <span id="display-customer-address">Μαρίνου Αντύπα 123, Καλαμάτα, Ελλάδα</span></p>
                        <p><strong>Ημερομηνία:</strong> 28 Ιουνίου 2025</p>
                        <p><strong>Ισχύς Προσφοράς μέχρι:</strong> 28 Ιουλίου 2025</p>
                    </div>
                    <div class="info-section">
                        <h3>Σύνοψη Συστήματος</h3>
                        <p><strong>Συνολική Ισχύς:</strong> <span id="total-capacity">2,18 kW</span></p>
                        <p><strong>Τύπος Πάνελ:</strong> <span id="panel-type-display">JKM435N-54HL4R-V</span></p>
                        <p><strong>Αριθμός Πάνελ:</strong> <span id="total-panels">5</span></p>
                        <p><strong>Μετατροπέας:</strong> <span id="inverter-display">EM5500-48L</span></p>
                        <p><strong>Χωρητικότητα Μπαταρίας:</strong> <span id="battery-display">15,5 kWh</span></p>
                    </div>
                </div>

                <div class="system-overview">
                    <h3>Επισκόπηση Συστήματος</h3>
                    <p>Το φωτοβολταϊκό σύστημα έχει σχεδιαστεί ειδικά για την ιδιοκτησία σας στην Καλαμάτα, αξιοποιώντας φωτοβολταϊκά πάνελ υψηλής απόδοσης και προηγμένη τεχνολογία μετατροπέα. Το σύστημα περιλαμβάνει αποθήκευση ενέργειας σε μπαταρίες για ενεργειακή ανεξαρτησία και θα παρέχει καθαρή, ανανεώσιμη ενέργεια για πολλά χρόνια.</p>
                    
                    <div style="margin-top: 15px;">
                        <strong>Διαμόρφωση Συστήματος:</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><span id="series-count">1</span> πάνελ σε σειρά × <span id="parallel-count">5</span> γραμμές παράλληλα</li>
                            <li>Τάση Συστήματος: <span id="system-voltage">435V</span></li>
                            <li>Ρεύμα Συστήματος: <span id="system-current">66,75A</span></li>
                            <li>Ετήσια Παραγωγή Ενέργειας: <span id="annual-production">3.900 kWh</span></li>
                        </ul>
                    </div>
                </div>

                <table class="pricing-table">
                    <thead>
                        <tr><th>Είδος</th><th>Περιγραφή</th><th>Ποσότητα</th><th>Τιμή Μονάδας</th><th>Σύνολο</th></tr>
                    </thead>
                    <tbody id="pricing-table-body">
                        <!-- Θα συμπληρωθεί από JavaScript -->
                    </tbody>
                </table>

                <div class="page-break">
                    <div class="quote-title">ΤΕΧΝΙΚΕΣ ΠΡΟΔΙΑΓΡΑΦΕΣ & ΑΝΑΛΥΣΗ</div>

                    <div class="info-section">
                        <h3>Προδιαγραφές Πάνελ</h3>
                        <div id="panel-specs">
                            <!-- Θα συμπληρωθεί από JavaScript -->
                        </div>
                    </div>

                    <div class="info-section" style="margin-top: 20px;">
                        <h3>Προδιαγραφές Μετατροπέα</h3>
                        <div id="inverter-specs">
                            <!-- Θα συμπληρωθεί από JavaScript -->
                        </div>
                    </div>

                    <div class="financial-metrics">
                        <div class="metric-card">
                            <div class="metric-value" id="payback-period">4,0</div>
                            <div class="metric-label">Έτη Περιόδου Απόσβεσης</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="annual-savings">€820</div>
                            <div class="metric-label">Ετήσια Εξοικονόμηση</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="lifetime-savings">€17.182</div>
                            <div class="metric-label">Συνολική Εξοικονόμηση 25ετίας</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="roi-percentage">24,7%</div>
                            <div class="metric-label">Ετήσια Απόδοση Επένδυσης</div>
                        </div>
                    </div>

                    <div class="environmental-section">
                        <h3>Περιβαλλοντικό Αποτύπωμα</h3>
                        <div class="financial-metrics">
                            <div class="metric-card">
                                <div class="metric-value" id="co2-reduction">1,95</div>
                                <div class="metric-label">Τόνοι CO₂ Εξοικονόμησης/Έτος</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="tree-equivalent">45</div>
                                <div class="metric-label">Ισοδύναμο Φυτεμένων Δέντρων</div>
                            </div>
                        </div>
                        <p style="margin-top: 15px; text-align: center; font-style: italic;">
                            Σε 25 χρόνια, το σύστημα θα εξοικονομήσει <span id="lifetime-co2">48,8</span> τόνους CO₂, 
                            ισοδύναμο με τη φύτευση <span id="lifetime-trees">1.125</span> δέντρων.
                        </p>
                    </div>

                    <div class="info-section" style="margin-top: 20px;">
                        <h3>Μηνιαία Πρόβλεψη Παραγωγής Ενέργειας</h3>
                        <table class="pricing-table">
                            <thead>
                                <tr><th>Μήνας</th><th>Ηλιακή Ακτινοβολία (kWh/m²/ημέρα)</th><th>Εκτιμώμενη Παραγωγή (kWh)</th></tr>
                            </thead>
                            <tbody id="monthly-production">
                                <!-- Θα συμπληρωθεί από JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="page-break">
                    <div class="quote-title">ΟΡΟΙ & ΠΡΟΫΠΟΘΕΣΕΙΣ</div>

                    <div class="terms-section">
                        <h3>Όροι Εγκατάστασης</h3>
                        <ul>
                            <li>Χρόνος εγκατάστασης: <span id="labor-hours">18,4</span> ώρες (2-3 εργάσιμες ημέρες)</li>
                            <li>Όλες οι ηλεκτρολογικές εργασίες εκτελούνται από πιστοποιημένους ηλεκτρολόγους</li>
                            <li>Η εγκατάσταση περιλαμβάνει υλικά στήριξης, ηλεκτρικές συνδέσεις και θέση σε λειτουργία</li>
                            <li>Επιτόπια επίσκεψη και στατική μελέτη περιλαμβάνονται στην τιμή</li>
                            <li>Παρακολούθηση συστήματος και επαλήθευση απόδοσης περιλαμβάνονται</li>
                        </ul>

                        <h3>Όροι Πληρωμής</h3>
                        <ul>
                            <li>Προκαταβολή 50% απαιτείται κατά την υπογραφή της σύμβασης</li>
                            <li>25% κατά την παράδοση του εξοπλισμού</li>
                            <li>25% τελική πληρωμή κατά τη θέση σε λειτουργία του συστήματος</li>
                            <li>Όλες οι τιμές περιλαμβάνουν Φ.Π.Α. όπου εφαρμόζεται</li>
                            <li>Η προσφορά ισχύει για 30 ημέρες από την ημερομηνία έκδοσης</li>
                        </ul>

                        <h3>Εγγυήσεις</h3>
                        <ul>
                            <li><strong>Φωτοβολταϊκά Πάνελ:</strong> 25ετής εγγύηση απόδοσης (80% ισχύς)</li>
                            <li><strong>Μετατροπέας:</strong> 10ετής εγγύηση κατασκευαστή</li>
                            <li><strong>Σύστημα Μπαταριών:</strong> 10ετής εγγύηση/10.000 κύκλων</li>
                            <li><strong>Εγκατάσταση:</strong> 5ετής εγγύηση εργασιών</li>
                            <li><strong>Παρακολούθηση:</strong> 5ετής παρακολούθηση συστήματος</li>
                        </ul>

                        <h3>Πρόσθετες Πληροφορίες</h3>
                        <ul>
                            <li>Άδειες και υποστήριξη σύνδεσης στο δίκτυο περιλαμβάνονται</li>
                            <li>Ετήσια υπηρεσία συντήρησης διαθέσιμη (προαιρετικά)</li>
                            <li>Το σύστημα είναι σχεδιασμένο για λειτουργική ζωή 25+ ετών</li>
                            <li>Συμβατότητα με net metering όπου εφαρμόζεται</li>
                            <li>Παρέχεται επαγγελματικός φάκελος τεκμηρίωσης συστήματος</li>
                        </ul>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 50px; margin-top: 50px; padding-top: 30px; border-top: 1px solid #ddd;">
                        <div style="text-align: center;">
                            <div style="border-bottom: 1px solid #333; margin-bottom: 10px; height: 40px;"></div>
                            <p><strong>Υπογραφή Πελάτη</strong></p>
                            <p>Ημερομηνία: _______________</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="border-bottom: 1px solid #333; margin-bottom: 10px; height: 40px;"></div>
                            <p><strong>Ήλιος Φωτοβολταϊκές Λύσεις</strong></p>
                            <p>Ημερομηνία: _______________</p>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd;">
                        <p><strong>Στοιχεία Επικοινωνίας</strong></p>
                        <p>Email: info@heliossolar.gr | Τηλέφωνο: +30 27210 12345</p>
                        <p>Διεύθυνση: Ηλιακή 123, Καλαμάτα 24100, Ελλάδα</p>
                        <p style="margin-top: 10px; font-style: italic;">Σας ευχαριστούμε που επιλέξατε την Ήλιος Φωτοβολταϊκές Λύσεις!</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <h3 style="color: #2c5282; margin-bottom: 20px; text-align: center;">Διαμόρφωση Συστήματος</h3>
            
            <div class="control-group">
                <label>Όνομα Πελάτη:</label>
                <input type="text" id="customer-name" value="Ιωάννης Παπαδόπουλος" oninput="updateAll()">
            </div>

            <div class="control-group">
                <label>Διεύθυνση Πελάτη:</label>
                <input type="text" id="customer-address" value="Μαρίνου Αντύπα 123, Καλαμάτα, Ελλάδα" oninput="updateAll()">
            </div>

            <div class="control-group">
                <label>Τύπος Πάνελ:</label>
                <select id="panel-type" onchange="updateAll()">
                    <option value="JKM435N-54HL4R-V">JKM435N-54HL4R-V (435W)</option>
                    <option value="Longi LR5-54HPB-410M">Longi LR5-54HPB-410M (410W)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Πάνελ σε Σειρά (1-20):</label>
                <input type="number" id="panels-series" min="1" max="20" value="1" oninput="updateAll()">
            </div>

            <div class="control-group">
                <label>Γραμμές Παράλληλα (1-10):</label>
                <input type="number" id="strings-parallel" min="1" max="10" value="5" oninput="updateAll()">
            </div>

            <div class="control-group">
                <label>Τύπος Μετατροπέα:</label>
                <select id="inverter-type" onchange="updateBatteryOptions()">
                    <option value="EM5500-48L">EM5500-48L (5500W, 48V)</option>
                    <option value="EM3500-24L">EM3500-24L (3500W, 24V)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Χωρητικότητα Μπαταρίας:</label>
                <select id="battery-capacity" onchange="updateAll()">
                    <option value="15.5">15,5 kWh (16 στοιχεία, 48V)</option>
                    <option value="31.0">31,0 kWh (32 στοιχεία, 48V)</option>
                    <option value="46.5">46,5 kWh (48 στοιχεία, 48V)</option>
                </select>
            </div>

            <button class="generate-btn" onclick="generatePDF()">Δημιουργία Προσφοράς PDF</button>
            
            <div style="margin-top: 10px; text-align: center; font-size: 12px; color: #666;">
                Εναλλακτικά: Πατήστε <strong>Ctrl+P</strong> (Windows) ή <strong>Cmd+P</strong> (Mac)
            </div>

            <div style="margin: 20px 0; padding: 15px; background: #e8f4f8; border-radius: 4px; border-left: 4px solid #2c5282;">
                <h4 style="color: #2c5282; margin-bottom: 15px;">Ανάλυση Ενεργειακών Αναγκών</h4>
                
                <div class="control-group">
                    <label>Μοντέλο Αντλίας Θερμότητας:</label>
                    <select id="heatpump-model">
                        <option value="AWH-M120/5R1">AWH-M120/5R1 (0.75kW θέρμανση, 0.85kW ψύξη)</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>Τετραγωνικά Μέτρα Σπιτιού:</label>
                    <input type="number" id="house-sqm" min="50" max="500" value="120" oninput="updateEnergyAnalysis()">
                </div>

                <button class="generate-btn" onclick="showEnergyPlot()" style="background: #28a745; margin-top: 10px;">
                    📊 Εμφάνιση Ανάλυσης Ενέργειας
                </button>
            </div>

            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; font-size: 12px;">
                <strong>Σύνοψη Συστήματος:</strong><br>
                Συνολικά Πάνελ: <span id="summary-panels">5</span><br>
                Συνολική Ισχύς: <span id="summary-capacity">2,18 kW</span><br>
                Συνολικό Κόστος: <span id="summary-cost">€3.318</span>
            </div>
        </div>
    </div>

    <script>
        window.onload = function() {
            updateBatteryOptions();
            updateAll();
        };
    </script>
</body>
</html>
