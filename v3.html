<!DOCTYPE html>

<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î£ÏÏƒÏ„Î·Î¼Î± Î ÏÎ¿ÏƒÏ†Î¿ÏÏÎ½ Î¦Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÏÎ½</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Times New Roman', serif; background-color: #f5f5f5; color: #333; }
        .container { display: flex; min-height: 100vh; }
        .document-area { flex: 1; padding: 20px; max-width: calc(100% - 320px); }
        .control-panel {
            width: 300px; position: fixed; right: 10px; top: 10px; background: white;
            border: 1px solid #ddd; border-radius: 8px; padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); height: calc(100vh - 20px);
            overflow-y: auto; z-index: 1000;
        }
        .quotation-document {
            background: white; padding: 40px; margin: 0 auto; max-width: 210mm;
            min-height: 297mm; box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .page-break { page-break-before: always; margin-top: 40px; padding-top: 40px; }
        .header { text-align: center; border-bottom: 3px solid #2c5282; padding-bottom: 20px; margin-bottom: 30px; }
        .company-name { font-size: 28px; font-weight: bold; color: #2c5282; margin-bottom: 5px; }
        .company-tagline { font-size: 14px; color: #666; font-style: italic; }
        .quote-title { font-size: 24px; font-weight: bold; text-align: center; margin: 30px 0; color: #2c5282; }
        .customer-info { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        .info-section { border: 1px solid #ddd; padding: 15px; border-radius: 4px; }
        .info-section h3 { font-size: 16px; margin-bottom: 10px; color: #2c5282; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .system-overview { margin: 30px 0; padding: 20px; background: #f8f9fa; border-left: 4px solid #2c5282; }
        .pricing-table { width: 100%; border-collapse: collapse; margin: 20px 0; border: 1px solid #ddd; }
        .pricing-table th, .pricing-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .pricing-table th { background: #2c5282; color: white; font-weight: bold; }
        .pricing-table tr:nth-child(even) { background: #f8f9fa; }
        .total-row { background: #e8f4f8 !important; font-weight: bold; }
        .control-group { margin-bottom: 20px; }
        .control-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; font-size: 14px; }
        .control-group input, .control-group select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .generate-btn {
            width: 100%; background: #2c5282; color: white; border: none; padding: 12px;
            border-radius: 4px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 20px;
        }
        .generate-btn:hover { background: #1a365d; }
        .financial-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .metric-card { padding: 15px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }
        .metric-value { font-size: 24px; font-weight: bold; color: #2c5282; }
        .metric-label { font-size: 12px; color: #666; margin-top: 5px; }
        .terms-section { margin-top: 30px; }
        .terms-section h3 { color: #2c5282; margin-bottom: 15px; font-size: 18px; }
        .terms-section ul { list-style-type: disc; margin-left: 20px; }
        .terms-section li { margin-bottom: 8px; line-height: 1.5; }
        .environmental-section { background: #e8f5e8; padding: 20px; border-radius: 4px; margin: 20px 0; }
        @media print {
            .control-panel { display: none !important; }
            .document-area { max-width: 100% !important; padding: 0 !important; margin: 0 !important; }
            .quotation-document { box-shadow: none !important; margin: 0 !important; padding: 15mm !important; max-width: none !important; width: 100% !important; }
            .page-break { page-break-before: always !important; margin-top: 0 !important; padding-top: 20px !important; }
            body { background: white !important; font-size: 12pt !important; line-height: 1.4 !important; }
            .container { display: block !important; }
        }
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .control-panel { position: relative; width: 100%; height: auto; order: 1; }
            .document-area { max-width: 100%; order: 2; }
            .customer-info, .financial-metrics { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="document-area">
            <div class="quotation-document">
                <div class="header">
                    <div class="company-name">Î—Î›Î™ÎŸÎ£ Î¦Î©Î¤ÎŸÎ’ÎŸÎ›Î¤Î‘ÎªÎšÎ•Î£ Î›Î¥Î£Î•Î™Î£</div>
                    <div class="company-tagline">Î¤ÏÎ¿Ï†Î¿Î´Î¿Ï„ÏÎ½Ï„Î±Ï‚ Ï„Î¿ ÎœÎ­Î»Î»Î¿Î½ ÏƒÎ±Ï‚ Î¼Îµ ÎšÎ±Î¸Î±ÏÎ® Î•Î½Î­ÏÎ³ÎµÎ¹Î±</div>
                </div>

```
            <div class="quote-title">Î Î¡ÎŸÎ£Î¦ÎŸÎ¡Î‘ Î¦Î©Î¤ÎŸÎ’ÎŸÎ›Î¤Î‘ÎªÎšÎŸÎ¥ Î£Î¥Î£Î¤Î—ÎœÎ‘Î¤ÎŸÎ£</div>

            <div class="customer-info">
                <div class="info-section">
                    <h3>Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î ÎµÎ»Î¬Ï„Î·</h3>
                    <p><strong>ÎŒÎ½Î¿Î¼Î±:</strong> <span id="display-customer-name">Î™Ï‰Î¬Î½Î½Î·Ï‚ Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚</span></p>
                    <p><strong>Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·:</strong> <span id="display-customer-address">ÎœÎ±ÏÎ¯Î½Î¿Ï… Î‘Î½Ï„ÏÏ€Î± 123, ÎšÎ±Î»Î±Î¼Î¬Ï„Î±, Î•Î»Î»Î¬Î´Î±</span></p>
                    <p><strong>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±:</strong> 28 Î™Î¿Ï…Î½Î¯Î¿Ï… 2025</p>
                    <p><strong>Î™ÏƒÏ‡ÏÏ‚ Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬Ï‚ Î¼Î­Ï‡ÏÎ¹:</strong> 28 Î™Î¿Ï…Î»Î¯Î¿Ï… 2025</p>
                </div>
                <div class="info-section">
                    <h3>Î£ÏÎ½Î¿ÏˆÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</h3>
                    <p><strong>Î£Ï…Î½Î¿Î»Î¹ÎºÎ® Î™ÏƒÏ‡ÏÏ‚:</strong> <span id="total-capacity">2,18 kW</span></p>
                    <p><strong>Î¤ÏÏ€Î¿Ï‚ Î Î¬Î½ÎµÎ»:</strong> <span id="panel-type-display">JKM435N-54HL4R-V</span></p>
                    <p><strong>Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î Î¬Î½ÎµÎ»:</strong> <span id="total-panels">5</span></p>
                    <p><strong>ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î­Î±Ï‚:</strong> <span id="inverter-display">EM5500-48L</span></p>
                    <p><strong>Î§Ï‰ÏÎ·Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± ÎœÏ€Î±Ï„Î±ÏÎ¯Î±Ï‚:</strong> <span id="battery-display">15,5 kWh</span></p>
                </div>
            </div>

            <div class="system-overview">
                <h3>Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</h3>
                <p>Î¤Î¿ Ï†Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÏŒ ÏƒÏÏƒÏ„Î·Î¼Î± Î­Ï‡ÎµÎ¹ ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÏ„ÎµÎ¯ ÎµÎ¹Î´Î¹ÎºÎ¬ Î³Î¹Î± Ï„Î·Î½ Î¹Î´Î¹Î¿ÎºÏ„Î·ÏƒÎ¯Î± ÏƒÎ±Ï‚ ÏƒÏ„Î·Î½ ÎšÎ±Î»Î±Î¼Î¬Ï„Î±, Î±Î¾Î¹Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï†Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÎ¬ Ï€Î¬Î½ÎµÎ» Ï…ÏˆÎ·Î»Î®Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ ÎºÎ±Î¹ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î· Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î­Î±. Î¤Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚ ÏƒÎµ Î¼Ï€Î±Ï„Î±ÏÎ¯ÎµÏ‚ Î³Î¹Î± ÎµÎ½ÎµÏÎ³ÎµÎ¹Î±ÎºÎ® Î±Î½ÎµÎ¾Î±ÏÏ„Î·ÏƒÎ¯Î± ÎºÎ±Î¹ Î¸Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ ÎºÎ±Î¸Î±ÏÎ®, Î±Î½Î±Î½ÎµÏÏƒÎ¹Î¼Î· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Î³Î¹Î± Ï€Î¿Î»Î»Î¬ Ï‡ÏÏŒÎ½Î¹Î±.</p>
                
                <div style="margin-top: 15px;">
                    <strong>Î”Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><span id="series-count">1</span> Ï€Î¬Î½ÎµÎ» ÏƒÎµ ÏƒÎµÎ¹ÏÎ¬ Ã— <span id="parallel-count">5</span> Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï€Î±ÏÎ¬Î»Î»Î·Î»Î±</li>
                        <li>Î¤Î¬ÏƒÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚: <span id="system-voltage">435V</span></li>
                        <li>Î¡ÎµÏÎ¼Î± Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚: <span id="system-current">66,75A</span></li>
                        <li>Î•Ï„Î®ÏƒÎ¹Î± Î Î±ÏÎ±Î³Ï‰Î³Î® Î•Î½Î­ÏÎ³ÎµÎ¹Î±Ï‚: <span id="annual-production">3.900 kWh</span></li>
                    </ul>
                </div>
            </div>

            <table class="pricing-table">
                <thead>
                    <tr><th>Î•Î¯Î´Î¿Ï‚</th><th>Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®</th><th>Î Î¿ÏƒÏŒÏ„Î·Ï„Î±</th><th>Î¤Î¹Î¼Î® ÎœÎ¿Î½Î¬Î´Î±Ï‚</th><th>Î£ÏÎ½Î¿Î»Î¿</th></tr>
                </thead>
                <tbody id="pricing-table-body">
                    <!-- Î˜Î± ÏƒÏ…Î¼Ï€Î»Î·ÏÏ‰Î¸ÎµÎ¯ Î±Ï€ÏŒ JavaScript -->
                </tbody>
            </table>

            <div class="page-break">
                <div class="quote-title">Î¤Î•Î§ÎÎ™ÎšÎ•Î£ Î Î¡ÎŸÎ”Î™Î‘Î“Î¡Î‘Î¦Î•Î£ & Î‘ÎÎ‘Î›Î¥Î£Î—</div>

                <div class="info-section">
                    <h3>Î ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î­Ï‚ Î Î¬Î½ÎµÎ»</h3>
                    <div id="panel-specs">
                        <p><strong>ÎœÎ¿Î½Ï„Î­Î»Î¿:</strong> JKM435N-54HL4R-V</p>
                        <p><strong>Î™ÏƒÏ‡ÏÏ‚ Î•Î¾ÏŒÎ´Î¿Ï…:</strong> 435W Î±Î½Î¬ Ï€Î¬Î½ÎµÎ»</p>
                        <p><strong>Î‘Ï€ÏŒÎ´Î¿ÏƒÎ·:</strong> 21,77%</p>
                        <p><strong>Î”Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚:</strong> 1,134m Ã— 1,762m</p>
                        <p><strong>ÎœÎ­Î³Î¹ÏƒÏ„Î· Î¤Î¬ÏƒÎ· Î™ÏƒÏ‡ÏÎ¿Ï‚:</strong> 32,59V</p>
                        <p><strong>ÎœÎ­Î³Î¹ÏƒÏ„Î¿ Î¡ÎµÏÎ¼Î± Î™ÏƒÏ‡ÏÎ¿Ï‚:</strong> 13,35A</p>
                    </div>
                </div>

                <div class="info-section" style="margin-top: 20px;">
                    <h3>Î ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î­Ï‚ ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î­Î±</h3>
                    <div id="inverter-specs">
                        <p><strong>ÎœÎ¿Î½Ï„Î­Î»Î¿:</strong> EM5500-48L</p>
                        <p><strong>Î™ÏƒÏ‡ÏÏ‚ Î•Î¾ÏŒÎ´Î¿Ï…:</strong> 5500W</p>
                        <p><strong>Î¤Î¬ÏƒÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚:</strong> 48V</p>
                        <p><strong>Î•ÏÏÎ¿Ï‚ MPPT:</strong> 120-500V</p>
                    </div>
                </div>

                <div class="financial-metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="payback-period">4,0</div>
                        <div class="metric-label">ÎˆÏ„Î· Î ÎµÏÎ¹ÏŒÎ´Î¿Ï… Î‘Ï€ÏŒÏƒÎ²ÎµÏƒÎ·Ï‚</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="annual-savings">â‚¬820</div>
                        <div class="metric-label">Î•Ï„Î®ÏƒÎ¹Î± Î•Î¾Î¿Î¹ÎºÎ¿Î½ÏŒÎ¼Î·ÏƒÎ·</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="lifetime-savings">â‚¬17.182</div>
                        <div class="metric-label">Î£Ï…Î½Î¿Î»Î¹ÎºÎ® Î•Î¾Î¿Î¹ÎºÎ¿Î½ÏŒÎ¼Î·ÏƒÎ· 25ÎµÏ„Î¯Î±Ï‚</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="roi-percentage">24,7%</div>
                        <div class="metric-label">Î•Ï„Î®ÏƒÎ¹Î± Î‘Ï€ÏŒÎ´Î¿ÏƒÎ· Î•Ï€Î­Î½Î´Ï…ÏƒÎ·Ï‚</div>
                    </div>
                </div>

                <div class="environmental-section">
                    <h3>Î ÎµÏÎ¹Î²Î±Î»Î»Î¿Î½Ï„Î¹ÎºÏŒ Î‘Ï€Î¿Ï„ÏÏ€Ï‰Î¼Î±</h3>
                    <div class="financial-metrics">
                        <div class="metric-card">
                            <div class="metric-value" id="co2-reduction">1,95</div>
                            <div class="metric-label">Î¤ÏŒÎ½Î¿Î¹ COâ‚‚ Î•Î¾Î¿Î¹ÎºÎ¿Î½ÏŒÎ¼Î·ÏƒÎ·Ï‚/ÎˆÏ„Î¿Ï‚</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="tree-equivalent">45</div>
                            <div class="metric-label">Î™ÏƒÎ¿Î´ÏÎ½Î±Î¼Î¿ Î¦Ï…Ï„ÎµÎ¼Î­Î½Ï‰Î½ Î”Î­Î½Ï„ÏÏ‰Î½</div>
                        </div>
                    </div>
                    <p style="margin-top: 15px; text-align: center; font-style: italic;">
                        Î£Îµ 25 Ï‡ÏÏŒÎ½Î¹Î±, Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î¸Î± ÎµÎ¾Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î®ÏƒÎµÎ¹ <span id="lifetime-co2">48,8</span> Ï„ÏŒÎ½Î¿Ï…Ï‚ COâ‚‚, 
                        Î¹ÏƒÎ¿Î´ÏÎ½Î±Î¼Î¿ Î¼Îµ Ï„Î· Ï†ÏÏ„ÎµÏ…ÏƒÎ· <span id="lifetime-trees">1.125</span> Î´Î­Î½Ï„ÏÏ‰Î½.
                    </p>
                </div>

                <div class="info-section" style="margin-top: 20px;">
                    <h3>ÎœÎ·Î½Î¹Î±Î¯Î± Î ÏÏŒÎ²Î»ÎµÏˆÎ· Î Î±ÏÎ±Î³Ï‰Î³Î®Ï‚ Î•Î½Î­ÏÎ³ÎµÎ¹Î±Ï‚</h3>
                    <table class="pricing-table">
                        <thead>
                            <tr><th>ÎœÎ®Î½Î±Ï‚</th><th>Î—Î»Î¹Î±ÎºÎ® Î‘ÎºÏ„Î¹Î½Î¿Î²Î¿Î»Î¯Î± (kWh/mÂ²/Î·Î¼Î­ÏÎ±)</th><th>Î•ÎºÏ„Î¹Î¼ÏÎ¼ÎµÎ½Î· Î Î±ÏÎ±Î³Ï‰Î³Î® (kWh)</th></tr>
                        </thead>
                        <tbody id="monthly-production">
                            <!-- Î˜Î± ÏƒÏ…Î¼Ï€Î»Î·ÏÏ‰Î¸ÎµÎ¯ Î±Ï€ÏŒ JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="page-break">
                <div class="quote-title">ÎŸÎ¡ÎŸÎ™ & Î Î¡ÎŸÎ«Î ÎŸÎ˜Î•Î£Î•Î™Î£</div>

                <div class="terms-section">
                    <h3>ÎŒÏÎ¿Î¹ Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚</h3>
                    <ul>
                        <li>Î§ÏÏŒÎ½Î¿Ï‚ ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚: <span id="labor-hours">18,4</span> ÏÏÎµÏ‚ (2-3 ÎµÏÎ³Î¬ÏƒÎ¹Î¼ÎµÏ‚ Î·Î¼Î­ÏÎµÏ‚)</li>
                        <li>ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î·Î»ÎµÎºÏ„ÏÎ¿Î»Î¿Î³Î¹ÎºÎ­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿Ï…Ï‚ Î·Î»ÎµÎºÏ„ÏÎ¿Î»ÏŒÎ³Î¿Ï…Ï‚</li>
                        <li>Î— ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï…Î»Î¹ÎºÎ¬ ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚, Î·Î»ÎµÎºÏ„ÏÎ¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î¸Î­ÏƒÎ· ÏƒÎµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±</li>
                        <li>Î•Ï€Î¹Ï„ÏŒÏ€Î¹Î± ÎµÏ€Î¯ÏƒÎºÎµÏˆÎ· ÎºÎ±Î¹ ÏƒÏ„Î±Ï„Î¹ÎºÎ® Î¼ÎµÎ»Î­Ï„Î· Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î·Î½ Ï„Î¹Î¼Î®</li>
                        <li>Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Î½Ï„Î±Î¹</li>
                    </ul>

                    <h3>ÎŒÏÎ¿Î¹ Î Î»Î·ÏÏ‰Î¼Î®Ï‚</h3>
                    <ul>
                        <li>Î ÏÎ¿ÎºÎ±Ï„Î±Î²Î¿Î»Î® 50% Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Ï„Î·Ï‚ ÏƒÏÎ¼Î²Î±ÏƒÎ·Ï‚</li>
                        <li>25% ÎºÎ±Ï„Î¬ Ï„Î·Î½ Ï€Î±ÏÎ¬Î´Î¿ÏƒÎ· Ï„Î¿Ï… ÎµÎ¾Î¿Ï€Î»Î¹ÏƒÎ¼Î¿Ï</li>
                        <li>25% Ï„ÎµÎ»Î¹ÎºÎ® Ï€Î»Î·ÏÏ‰Î¼Î® ÎºÎ±Ï„Î¬ Ï„Î· Î¸Î­ÏƒÎ· ÏƒÎµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</li>
                        <li>ÎŒÎ»ÎµÏ‚ Î¿Î¹ Ï„Î¹Î¼Î­Ï‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ Î¦.Î .Î‘. ÏŒÏ€Î¿Ï… ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹</li>
                        <li>Î— Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ¬ Î¹ÏƒÏ‡ÏÎµÎ¹ Î³Î¹Î± 30 Î·Î¼Î­ÏÎµÏ‚ Î±Ï€ÏŒ Ï„Î·Î½ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î­ÎºÎ´Î¿ÏƒÎ·Ï‚</li>
                    </ul>

                    <h3>Î•Î³Î³Ï…Î®ÏƒÎµÎ¹Ï‚</h3>
                    <ul>
                        <li><strong>Î¦Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÎ¬ Î Î¬Î½ÎµÎ»:</strong> 25ÎµÏ„Î®Ï‚ ÎµÎ³Î³ÏÎ·ÏƒÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ (80% Î¹ÏƒÏ‡ÏÏ‚)</li>
                        <li><strong>ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î­Î±Ï‚:</strong> 10ÎµÏ„Î®Ï‚ ÎµÎ³Î³ÏÎ·ÏƒÎ· ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î±ÏƒÏ„Î®</li>
                        <li><strong>Î£ÏÏƒÏ„Î·Î¼Î± ÎœÏ€Î±Ï„Î±ÏÎ¹ÏÎ½:</strong> 10ÎµÏ„Î®Ï‚ ÎµÎ³Î³ÏÎ·ÏƒÎ·/10.000 ÎºÏÎºÎ»Ï‰Î½</li>
                        <li><strong>Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·:</strong> 5ÎµÏ„Î®Ï‚ ÎµÎ³Î³ÏÎ·ÏƒÎ· ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½</li>
                        <li><strong>Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·:</strong> 5ÎµÏ„Î®Ï‚ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</li>
                    </ul>

                    <h3>Î ÏÏŒÏƒÎ¸ÎµÏ„ÎµÏ‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚</h3>
                    <ul>
                        <li>Î†Î´ÎµÎ¹ÎµÏ‚ ÎºÎ±Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Î½Ï„Î±Î¹</li>
                        <li>Î•Ï„Î®ÏƒÎ¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÏ…Î½Ï„Î®ÏÎ·ÏƒÎ·Ï‚ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬)</li>
                        <li>Î¤Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î¿ Î³Î¹Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ® Î¶Ï‰Î® 25+ ÎµÏ„ÏÎ½</li>
                        <li>Î£Ï…Î¼Î²Î±Ï„ÏŒÏ„Î·Ï„Î± Î¼Îµ net metering ÏŒÏ€Î¿Ï… ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹</li>
                        <li>Î Î±ÏÎ­Ï‡ÎµÏ„Î±Î¹ ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÏŒÏ‚ Ï†Î¬ÎºÎµÎ»Î¿Ï‚ Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·Ï‚ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</li>
                    </ul>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 50px; margin-top: 50px; padding-top: 30px; border-top: 1px solid #ddd;">
                    <div style="text-align: center;">
                        <div style="border-bottom: 1px solid #333; margin-bottom: 10px; height: 40px;"></div>
                        <p><strong>Î¥Ï€Î¿Î³ÏÎ±Ï†Î® Î ÎµÎ»Î¬Ï„Î·</strong></p>
                        <p>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±: _______________</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="border-bottom: 1px solid #333; margin-bottom: 10px; height: 40px;"></div>
                        <p><strong>Î‰Î»Î¹Î¿Ï‚ Î¦Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÎ­Ï‚ Î›ÏÏƒÎµÎ¹Ï‚</strong></p>
                        <p>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±: _______________</p>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd;">
                    <p><strong>Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚</strong></p>
                    <p>Email: info@heliossolar.gr | Î¤Î·Î»Î­Ï†Ï‰Î½Î¿: +30 27210 12345</p>
                    <p>Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·: Î—Î»Î¹Î±ÎºÎ® 123, ÎšÎ±Î»Î±Î¼Î¬Ï„Î± 24100, Î•Î»Î»Î¬Î´Î±</p>
                    <p style="margin-top: 10px; font-style: italic;">Î£Î±Ï‚ ÎµÏ…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ Ï€Î¿Ï… ÎµÏ€Î¹Î»Î­Î¾Î±Ï„Îµ Ï„Î·Î½ Î‰Î»Î¹Î¿Ï‚ Î¦Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÎ­Ï‚ Î›ÏÏƒÎµÎ¹Ï‚!</p>
                </div>
            </div>
        </div>
    </div>

    <div class="control-panel">
        <h3 style="color: #2c5282; margin-bottom: 20px; text-align: center;">Î”Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</h3>
        
        <div class="control-group">
            <label>ÎŒÎ½Î¿Î¼Î± Î ÎµÎ»Î¬Ï„Î·:</label>
            <input type="text" id="customer-name" value="Î™Ï‰Î¬Î½Î½Î·Ï‚ Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚" oninput="updateAll()">
        </div>

        <div class="control-group">
            <label>Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î ÎµÎ»Î¬Ï„Î·:</label>
            <input type="text" id="customer-address" value="ÎœÎ±ÏÎ¯Î½Î¿Ï… Î‘Î½Ï„ÏÏ€Î± 123, ÎšÎ±Î»Î±Î¼Î¬Ï„Î±, Î•Î»Î»Î¬Î´Î±" oninput="updateAll()">
        </div>

        <div class="control-group">
            <label>Î¤ÏÏ€Î¿Ï‚ Î Î¬Î½ÎµÎ»:</label>
            <select id="panel-type" onchange="updateAll()">
                <option value="JKM435N-54HL4R-V">JKM435N-54HL4R-V (435W)</option>
                <option value="Longi LR5-54HPB-410M">Longi LR5-54HPB-410M (410W)</option>
            </select>
        </div>

        <div class="control-group">
            <label>Î Î¬Î½ÎµÎ» ÏƒÎµ Î£ÎµÎ¹ÏÎ¬ (1-20):</label>
            <input type="number" id="panels-series" min="1" max="20" value="1" oninput="updateAll()">
        </div>

        <div class="control-group">
            <label>Î“ÏÎ±Î¼Î¼Î­Ï‚ Î Î±ÏÎ¬Î»Î»Î·Î»Î± (1-10):</label>
            <input type="number" id="strings-parallel" min="1" max="10" value="5" oninput="updateAll()">
        </div>

        <div class="control-group">
            <label>Î¤ÏÏ€Î¿Ï‚ ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î­Î±:</label>
            <select id="inverter-type" onchange="updateBatteryOptions()">
                <option value="EM5500-48L">EM5500-48L (5500W, 48V)</option>
                <option value="EM3500-24L">EM3500-24L (3500W, 24V)</option>
            </select>
        </div>

        <div class="control-group">
            <label>Î§Ï‰ÏÎ·Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± ÎœÏ€Î±Ï„Î±ÏÎ¯Î±Ï‚:</label>
            <select id="battery-capacity" onchange="updateAll()">
                <option value="15.5">15,5 kWh (16 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 48V)</option>
                <option value="31.0">31,0 kWh (32 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 48V)</option>
                <option value="46.5">46,5 kWh (48 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 48V)</option>
            </select>
        </div>

        <button class="generate-btn" onclick="generatePDF()">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬Ï‚ PDF</button>
        
        <div style="margin-top: 10px; text-align: center; font-size: 12px; color: #666;">
            Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ¬: Î Î±Ï„Î®ÏƒÏ„Îµ <strong>Ctrl+P</strong> (Windows) Î® <strong>Cmd+P</strong> (Mac)
        </div>

        <div style="margin: 20px 0; padding: 15px; background: #e8f4f8; border-radius: 4px; border-left: 4px solid #2c5282;">
            <h4 style="color: #2c5282; margin-bottom: 15px;">Î‘Î½Î¬Î»Ï…ÏƒÎ· Î•Î½ÎµÏÎ³ÎµÎ¹Î±ÎºÏÎ½ Î‘Î½Î±Î³ÎºÏÎ½</h4>
            
            <div class="control-group">
                <label>ÎœÎ¿Î½Ï„Î­Î»Î¿ Î‘Î½Ï„Î»Î¯Î±Ï‚ Î˜ÎµÏÎ¼ÏŒÏ„Î·Ï„Î±Ï‚:</label>
                <select id="heatpump-model">
                    <option value="AWH-M120/5R1">AWH-M120/5R1 (0.75kW Î¸Î­ÏÎ¼Î±Î½ÏƒÎ·, 0.85kW ÏˆÏÎ¾Î·)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Î¤ÎµÏ„ÏÎ±Î³Ï‰Î½Î¹ÎºÎ¬ ÎœÎ­Ï„ÏÎ± Î£Ï€Î¹Ï„Î¹Î¿Ï:</label>
                <input type="number" id="house-sqm" min="50" max="500" value="120" oninput="updateEnergyAnalysis()">
            </div>

            <button class="generate-btn" onclick="showEnergyPlot()" style="background: #28a745; margin-top: 10px;">
                ğŸ“Š Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î‘Î½Î¬Î»Ï…ÏƒÎ·Ï‚ Î•Î½Î­ÏÎ³ÎµÎ¹Î±Ï‚
            </button>
        </div>

        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; font-size: 12px;">
            <strong>Î£ÏÎ½Î¿ÏˆÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚:</strong><br>
            Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Î¬Î½ÎµÎ»: <span id="summary-panels">5</span><br>
            Î£Ï…Î½Î¿Î»Î¹ÎºÎ® Î™ÏƒÏ‡ÏÏ‚: <span id="summary-capacity">2,18 kW</span><br>
            Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚: <span id="summary-cost">â‚¬3.318</span>
        </div>
    </div>
</div>

<script>
    const panels = {
        'JKM435N-54HL4R-V': { power: 435, efficiency: 21.77, width: 1.134, height: 1.762, maxVoltage: 32.59, maxCurrent: 13.35, price: 95 },
        'Longi LR5-54HPB-410M': { power: 410, efficiency: 21.0, width: 1.134, height: 1.722, maxVoltage: 31.25, maxCurrent: 13.12, price: 105 }
    };

    const inverters = {
        'EM5500-48L': { power: 5500, voltage: 48, mpptMin: 120, mpptMax: 500, price: 499 },
        'EM3500-24L': { power: 3500, voltage: 24, mpptMin: 30, mpptMax: 160, price: 339 }
    };

    function updateBatteryOptions() {
        const inverterType = document.getElementById('inverter-type').value;
        const batterySelect = document.getElementById('battery-capacity');
        
        if (inverterType === 'EM5500-48L') {
            batterySelect.innerHTML = `
                <option value="15.5">15,5 kWh (16 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 48V)</option>
                <option value="31.0">31,0 kWh (32 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 48V)</option>
                <option value="46.5">46,5 kWh (48 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 48V)</option>
            `;
        } else {
            batterySelect.innerHTML = `
                <option value="7.75">7,75 kWh (8 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 24V)</option>
                <option value="15.5">15,5 kWh (16 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 24V)</option>
                <option value="23.25">23,25 kWh (24 ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±, 24V)</option>
            `;
        }
        updateAll();
    }

    function updateAll() {
        const panelType = document.getElementById('panel-type').value;
        const seriesCount = parseInt(document.getElementById('panels-series').value) || 1;
        const parallelCount = parseInt(document.getElementById('strings-parallel').value) || 1;
        const inverterType = document.getElementById('inverter-type').value;
        const batteryCapacity = parseFloat(document.getElementById('battery-capacity').value) || 15.5;
        const customerName = document.getElementById('customer-name').value;
        const customerAddress = document.getElementById('customer-address').value;

        const panel = panels[panelType];
        const inverter = inverters[inverterType];

        const totalPanels = seriesCount * parallelCount;
        const totalCapacity = (totalPanels * panel.power) / 1000;
        const systemVoltage = seriesCount * panel.maxVoltage;
        const systemCurrent = parallelCount * panel.maxCurrent;

        const panelArea = panel.width * panel.height;
        const totalArea = totalPanels * panelArea;
        const annualProduction = Math.round(totalArea * 4.9 * 365 * (panel.efficiency / 100));

        const panelCost = totalPanels * panel.price;
        const panelBaseCost = totalPanels * 50;
        const inverterCost = inverter.price;
        
        let batteryCells = inverterType === 'EM5500-48L' ? 
            Math.round((batteryCapacity / 15.5) * 16) : 
            Math.round((batteryCapacity / 7.75) * 8);
        const batteryCost = batteryCells * 110 + 150;

        const laborHours = Math.max(15, Math.min(25, 15 + (totalPanels - 3) * 1.2));
        const laborCost = Math.round(laborHours * 10);
        const totalCost = panelCost + panelBaseCost + inverterCost + batteryCost + laborCost;

        const annualSavings = Math.round(annualProduction * 0.21);
        const paybackPeriod = (totalCost / annualSavings).toFixed(1);
        const lifetimeSavings = Math.round((annualSavings * 25) - totalCost);
        const roiPercentage = ((annualSavings / totalCost) * 100).toFixed(1);

        const annualCO2Reduction = (annualProduction * 0.5 / 1000).toFixed(2);
        const treeEquivalent = Math.round(annualCO2Reduction * 23);

        // Update display elements
        document.getElementById('display-customer-name').textContent = customerName;
        document.getElementById('display-customer-address').textContent = customerAddress;
        document.getElementById('total-capacity').textContent = totalCapacity.toFixed(2) + ' kW';
        document.getElementById('panel-type-display').textContent = panelType;
        document.getElementById('total-panels').textContent = totalPanels;
        document.getElementById('inverter-display').textContent = inverterType;
        document.getElementById('battery-display').textContent = batteryCapacity + ' kWh';
        document.getElementById('series-count').textContent = seriesCount;
        document.getElementById('parallel-count').textContent = parallelCount;
        document.getElementById('system-voltage').textContent = systemVoltage.toFixed(0) + 'V';
        document.getElementById('system-current').textContent = systemCurrent.toFixed(2) + 'A';
        document.getElementById('annual-production').textContent = annualProduction.toLocaleString() + ' kWh';

        // Update pricing table
        document.getElementById('pricing-table-body').innerHTML = `
            <tr><td>Î¦Ï‰Ï„Î¿Î²Î¿Î»Ï„Î±ÏŠÎºÎ¬ Î Î¬Î½ÎµÎ»</td><td>${panelType} (${panel.power}W Î­ÎºÎ±ÏƒÏ„Î¿)</td><td>${totalPanels}</td><td>â‚¬${panel.price}</td><td>â‚¬${panelCost}</td></tr>
            <tr><td>Î’Î¬ÏƒÎµÎ¹Ï‚ & Î£Ï„Î®ÏÎ¹Î¾Î· Î Î¬Î½ÎµÎ»</td><td>Î¥Î»Î¹ÎºÎ¬ ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ ÎºÎ±Î¹ Î²Î¬ÏƒÎµÎ¹Ï‚</td><td>${totalPanels}</td><td>â‚¬50</td><td>â‚¬${panelBaseCost}</td></tr>
            <tr><td>ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î­Î±Ï‚</td><td>${inverterType} (${inverter.power}W, ${inverter.voltage}V)</td><td>1</td><td>â‚¬${inverter.price}</td><td>â‚¬${inverterCost}</td></tr>
            <tr><td>Î£ÏÏƒÏ„Î·Î¼Î± ÎœÏ€Î±Ï„Î±ÏÎ¹ÏÎ½</td><td>${batteryCapacity} kWh (${batteryCells} ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± + BMS)</td><td>1</td><td>â‚¬${batteryCost}</td><td>â‚¬${batteryCost}</td></tr>
            <tr><td>Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚</td><td>Î•Ï€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÎ® ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· (${laborHours.toFixed(1)} ÏÏÎµÏ‚)</td><td>1</td><td>â‚¬${laborCost}</td><td>â‚¬${laborCost}</td></tr>
            <tr class="total-row"><td colspan="4"><strong>Î£Î¥ÎÎŸÎ›Î™ÎšÎŸ ÎšÎŸÎ£Î¤ÎŸÎ£ Î£Î¥Î£Î¤Î—ÎœÎ‘Î¤ÎŸÎ£</strong></td><td><strong>â‚¬${totalCost}</strong></td></tr>
        `;

        // Update specs
        document.getElementById('panel-specs').innerHTML = `
            <p><strong>ÎœÎ¿Î½Ï„Î­Î»Î¿:</strong> ${panelType}</p>
            <p><strong>Î™ÏƒÏ‡ÏÏ‚ Î•Î¾ÏŒÎ´Î¿Ï…:</strong> ${panel.power}W Î±Î½Î¬ Ï€Î¬Î½ÎµÎ»</p>
            <p><strong>Î‘Ï€ÏŒÎ´Î¿ÏƒÎ·:</strong> ${panel.efficiency}%</p>
            <p><strong>Î”Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚:</strong> ${panel.width}m Ã— ${panel.height}m</p>
            <p><strong>ÎœÎ­Î³Î¹ÏƒÏ„Î· Î¤Î¬ÏƒÎ· Î™ÏƒÏ‡ÏÎ¿Ï‚:</strong> ${panel.maxVoltage}V</p>
            <p><strong>ÎœÎ­Î³Î¹ÏƒÏ„Î¿ Î¡ÎµÏÎ¼Î± Î™ÏƒÏ‡ÏÎ¿Ï‚:</strong> ${panel.maxCurrent}A</p>
        `;

        document.getElementById('inverter-specs').innerHTML = `
            <p><strong>ÎœÎ¿Î½Ï„Î­Î»Î¿:</strong> ${inverterType}</p>
            <p><strong>Î™ÏƒÏ‡ÏÏ‚ Î•Î¾ÏŒÎ´Î¿Ï…:</strong> ${inverter.power}W</p>
            <p><strong>Î¤Î¬ÏƒÎ· Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚:</strong> ${inverter.voltage}V</p>
            <p><strong>Î•ÏÏÎ¿Ï‚ MPPT:</strong> ${inverter.mpptMin}-${inverter.mpptMax}V</p>
        `;

        // Update financial metrics
        document.getElementById('payback-period').textContent = paybackPeriod;
        document.getElementById('annual-savings').textContent = 'â‚¬' + annualSavings.toLocaleString();
        document.getElementById('lifetime-savings').textContent = 'â‚¬' + lifetimeSavings.toLocaleString();
        document.getElementById('roi-percentage').textContent = roiPercentage + '%';
        document.getElementById('co2-reduction').textContent = annualCO2Reduction;
        document.getElementById('tree-equivalent').textContent = treeEquivalent;
        document.getElementById('lifetime-co2').textContent = (annualCO2Reduction * 25).toFixed(1);
        document.getElementById('lifetime-trees').textContent = Math.round(treeEquivalent * 25);
        document.getElementById('labor-hours').textContent = laborHours.toFixed(1);

        // Update summary
        document.getElementById('summary-panels').textContent = totalPanels;
        document.getElementById('summary-capacity').textContent = totalCapacity.toFixed(2) + ' kW';
        document.getElementById('summary-cost').textContent = 'â‚¬' + totalCost.toLocaleString();

        // Update monthly production
        updateMonthlyProduction(totalArea, panel.efficiency);
    }

    function updateMonthlyProduction(totalArea, efficiency) {
        const monthlyIrradiance = [2.5, 3.3, 4.7, 6.1, 7.1, 7.9, 7.9, 7.0, 5.6, 4.0, 2.7, 2.2];
        const monthNames = ['Î™Î±Î½', 'Î¦ÎµÎ²', 'ÎœÎ¬Ï', 'Î‘Ï€Ï', 'ÎœÎ¬Î¹', 'Î™Î¿ÏÎ½', 'Î™Î¿ÏÎ»', 'Î‘ÏÎ³', 'Î£ÎµÏ€', 'ÎŸÎºÏ„', 'ÎÎ¿Îµ', 'Î”ÎµÎº'];
        const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        
        const monthlyTableBody = document.getElementById('monthly-production');
        if (!monthlyTableBody) return;
        
        let html = '';
        monthlyIrradiance.forEach((irradiance, index) => {
            const monthlyProduction = Math.round(totalArea * irradiance * daysInMonth[index] * (efficiency / 100));
            html += `
                <tr>
                    <td>${monthNames[index]}</td>
                    <td>${irradiance}</td>
                    <td>${monthlyProduction}</td>
                </tr>
            `;
        });
        monthlyTableBody.innerHTML = html;
    }

    function generatePDF() {
        const btn = document.querySelector('.generate-btn');
        const originalText = btn.textContent;
        
        try {
            btn.textContent = 'Î†Î½Î¿Î¹Î³Î¼Î± Î”Î¹Î±Î»ÏŒÎ³Î¿Ï… Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ·Ï‚...';
            btn.style.background = '#28a745';
            
            if (window.print) {
                window.print();
            } else {
                alert('Î— Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ·Ï‚ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î·. Î Î±ÏÎ±ÎºÎ±Î»Ï Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ctrl+P (Windows) Î® Cmd+P (Mac) Î³Î¹Î± ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ·.');
            }
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '#2c5282';
            }, 1500);
            
        } catch (error) {
            console.error('Î£Ï†Î¬Î»Î¼Î± ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ·Ï‚:', error);
            alert('Î‘Î´Ï…Î½Î±Î¼Î¯Î± Î±Î½Î¿Î¯Î³Î¼Î±Ï„Î¿Ï‚ Î´Î¹Î±Î»ÏŒÎ³Î¿Ï… ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ·Ï‚. Î Î±ÏÎ±ÎºÎ±Î»Ï Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ctrl+P (Windows) Î® Cmd+P (Mac) Î³Î¹Î± ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ·.');
            btn.textContent = originalText;
            btn.style.background = '#2c5282';
        }
    }

    function updateEnergyAnalysis() {
        // Placeholder for energy analysis updates
    }

    function showEnergyPlot() {
        try {
            const panelType = document.getElementById('panel-type').value;
            const seriesCount = parseInt(document.getElementById('panels-series').value) || 1;
            const parallelCount = parseInt(document.getElementById('strings-parallel').value) || 1;
            const batteryCapacity = parseFloat(document.getElementById('battery-capacity').value) || 15.5;
            const houseSqm = parseInt(document.getElementById('house-sqm').value) || 120;

            const panel = panels[panelType];
            const totalPanels = seriesCount * parallelCount;
            const totalArea = totalPanels * panel.width * panel.height;

            // Kalamata climate data
            const climate = [
                {month: "Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚", avgTemp: 10.4, days: 31},
                {month: "Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚", avgTemp: 10.7, days: 28}, 
                {month: "ÎœÎ¬ÏÏ„Î¹Î¿Ï‚", avgTemp: 12.1, days: 31},
                {month: "Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚", avgTemp: 14.6, days: 30},
                {month: "ÎœÎ¬Î¹Î¿Ï‚", avgTemp: 18.4, days: 31},
                {month: "Î™Î¿ÏÎ½Î¹Î¿Ï‚", avgTemp: 22.4, days: 30},
                {month: "Î™Î¿ÏÎ»Î¹Î¿Ï‚", avgTemp: 24.7, days: 31},
                {month: "Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚", avgTemp: 24.8, days: 31},
                {month: "Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚", avgTemp: 22.5, days: 30},
                {month: "ÎŸÎºÏ„ÏÎ²ÏÎ¹Î¿Ï‚", avgTemp: 18.9, days: 31},
                {month: "ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚", avgTemp: 15.2, days: 30},
                {month: "Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚", avgTemp: 12.0, days: 31}
            ];

            const solarIrradiance = [2.5, 3.3, 4.7, 6.1, 7.1, 7.9, 7.9, 7.0, 5.6, 4.0, 2.7, 2.2];
            
            // Create modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            const content = document.createElement('div');
            content.style.cssText = `
                background: white; border-radius: 12px; max-width: 1000px; width: 100%; 
                max-height: 90vh; overflow-y: auto; padding: 30px;
            `;
            
            let tableHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #2c5282; padding-bottom: 15px;">
                    <h2 style="color: #2c5282; margin: 0;">ğŸ“Š ÎœÎ·Î½Î¹Î±Î¯Î± Î‘Î½Î¬Î»Ï…ÏƒÎ· Î•Î½Î­ÏÎ³ÎµÎ¹Î±Ï‚</h2>
                    <button onclick="this.closest('div').parentElement.remove()" 
                            style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; font-size: 16px; cursor: pointer;">âœ–</button>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 25px; text-align: center;">
                    <strong>Î£ÏÏƒÏ„Î·Î¼Î±:</strong> ${totalPanels} Ï€Î¬Î½ÎµÎ» Ã— ${panel.power}W | 
                    <strong>ÎœÏ€Î±Ï„Î±ÏÎ¯Î±:</strong> ${batteryCapacity} kWh | 
                    <strong>Î£Ï€Î¯Ï„Î¹:</strong> ${houseSqm} mÂ² | 
                    <strong>Î£Ï„ÏŒÏ‡Î¿Ï‚:</strong> 21Â°C
                </div>

                <table style="width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px;">
                    <thead>
                        <tr style="background: #2c5282; color: white;">
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">ÎœÎ®Î½Î±Ï‚</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">ÎœÎ­ÏƒÎ· Î˜ÎµÏÎ¼.</th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Î‘Î½Ï„Î»Î¯Î± Î˜ÎµÏÎ¼.<br><span style="font-size: 11px;">(kWh/Î·Î¼Î­ÏÎ±)</span></th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Î—Î»Î¹Î±ÎºÎ® Î Î±ÏÎ±Î³Ï‰Î³Î®<br><span style="font-size: 11px;">(kWh/Î¼Î®Î½Î±)</span></th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·<br><span style="font-size: 11px;">(kWh/Î¼Î®Î½Î±)</span></th>
                            <th style="padding: 12px; border: 1px solid #ddd;">Î‘Ï€ÏŒ Î”Î¯ÎºÏ„Ï…Î¿<br><span style="font-size: 11px;">(kWh/Î¼Î®Î½Î±)</span></th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            let yearlyTotals = {
                heatPumpTotal: 0,
                solarTotal: 0,
                batteryTotal: 0,
                gridTotal: 0
            };

            climate.forEach((month, index) => {
                // Calculate heat pump consumption
                const tempDiff = Math.abs(month.avgTemp - 21);
                let dailyHeatPumpConsumption;
                
                if (month.avgTemp < 21) {
                    // Heating mode - more energy needed in cold
                    dailyHeatPumpConsumption = (2 + tempDiff * 0.8) * (houseSqm / 100);
                } else {
                    // Cooling mode - less energy for mild cooling
                    dailyHeatPumpConsumption = Math.max(0, (tempDiff - 1) * 0.6) * (houseSqm / 100);
                }
                
                const monthlyHeatPumpConsumption = dailyHeatPumpConsumption * month.days;
                
                // Calculate solar production
                const monthlySolarProduction = Math.round(totalArea * solarIrradiance[index] * month.days * (panel.efficiency / 100));
                
                // Calculate battery storage (what we can store from excess solar)
                const excessSolar = Math.max(0, monthlySolarProduction - monthlyHeatPumpConsumption);
                const maxBatteryStorage = batteryCapacity * 15; // Assume 15 cycles per month
                const batteryStorage = Math.min(excessSolar, maxBatteryStorage);
                
                // Calculate grid usage (shortfall after solar + stored energy)
                const shortfall = Math.max(0, monthlyHeatPumpConsumption - monthlySolarProduction);
                const gridUsage = Math.max(0, shortfall - batteryStorage);
                
                // Add to yearly totals
                yearlyTotals.heatPumpTotal += monthlyHeatPumpConsumption;
                yearlyTotals.solarTotal += monthlySolarProduction;
                yearlyTotals.batteryTotal += batteryStorage;
                yearlyTotals.gridTotal += gridUsage;
                
                tableHTML += `
                    <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                        <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">${month.month}</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">${month.avgTemp.toFixed(1)}Â°C</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: black; font-weight: bold;">
                            ${dailyHeatPumpConsumption.toFixed(1)} kWh
                            <div style="font-size: 11px; color: #666;">(${monthlyHeatPumpConsumption.toFixed(0)} kWh/Î¼Î®Î½Î±)</div>
                        </td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #ff8c00; font-weight: bold;">
                            ${monthlySolarProduction} kWh
                        </td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #28a745; font-weight: bold;">
                            ${batteryStorage.toFixed(0)} kWh
                        </td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #dc3545; font-weight: bold;">
                            ${gridUsage.toFixed(0)} kWh
                        </td>
                    </tr>
                `;
            });

            // Calculate percentages for overview
            const solarCoverage = Math.round((yearlyTotals.solarTotal / yearlyTotals.heatPumpTotal) * 100);
            const batteryCoverage = Math.round((yearlyTotals.batteryTotal / yearlyTotals.heatPumpTotal) * 100);
            const gridDependency = Math.round((yearlyTotals.gridTotal / yearlyTotals.heatPumpTotal) * 100);
            const totalSavings = Math.round((yearlyTotals.solarTotal + yearlyTotals.batteryTotal) * 0.21);
            const gridCost = Math.round(yearlyTotals.gridTotal * 0.21);

            tableHTML += `
                    </tbody>
                </table>

                <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white;">
                    <h3 style="margin-bottom: 20px; text-align: center;">ğŸ“ˆ Î•Ï„Î®ÏƒÎ¹Î± Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; text-align: center;">
                        <div>
                            <div style="font-size: 28px; font-weight: bold; color: black;">${yearlyTotals.heatPumpTotal.toFixed(0)}</div>
                            <div style="font-size: 14px; opacity: 0.9;">Î£Ï…Î½Î¿Î»Î¹ÎºÎ® ÎšÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ· kWh</div>
                        </div>
                        <div>
                            <div style="font-size: 28px; font-weight: bold; color: #ffd700;">${yearlyTotals.solarTotal.toFixed(0)}</div>
                            <div style="font-size: 14px; opacity: 0.9;">Î—Î»Î¹Î±ÎºÎ® Î Î±ÏÎ±Î³Ï‰Î³Î® kWh</div>
                        </div>
                        <div>
                            <div style="font-size: 28px; font-weight: bold; color: #90ee90;">${solarCoverage}%</div>
                            <div style="font-size: 14px; opacity: 0.9;">ÎšÎ¬Î»Ï…ÏˆÎ· Î±Ï€ÏŒ Î—Î»Î¹Î±ÎºÎ¬</div>
                        </div>
                        <div>
                            <div style="font-size: 28px; font-weight: bold; color: #ffb6c1;">â‚¬${totalSavings}</div>
                            <div style="font-size: 14px; opacity: 0.9;">Î•Ï„Î®ÏƒÎ¹Î± Î•Î¾Î¿Î¹ÎºÎ¿Î½ÏŒÎ¼Î·ÏƒÎ·</div>
                        </div>
                        <div>
                            <div style="font-size: 28px; font-weight: bold; color: #ff6b6b;">â‚¬${gridCost}</div>
                            <div style="font-size: 14px; opacity: 0.9;">ÎšÏŒÏƒÏ„Î¿Ï‚ Î”Î¹ÎºÏ„ÏÎ¿Ï…</div>
                        </div>
                        <div>
                            <div style="font-size: 28px; font-weight: bold; color: ${gridDependency < 20 ? '#90ee90' : gridDependency < 50 ? '#ffd700' : '#ff6b6b'};">${gridDependency}%</div>
                            <div style="font-size: 14px; opacity: 0.9;">Î•Î¾Î¬ÏÏ„Î·ÏƒÎ· Î±Ï€ÏŒ Î”Î¯ÎºÏ„Ï…Î¿</div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; font-size: 13px; color: #2d5016;">
                    <strong>ğŸ’¡ Î•Ï€ÎµÎ¾Î®Î³Î·ÏƒÎ· Î§ÏÏ‰Î¼Î¬Ï„Ï‰Î½:</strong><br>
                    <span style="color: black; font-weight: bold;">ÎœÎ±ÏÏÎ¿:</span> Î—Î¼ÎµÏÎ®ÏƒÎ¹Î± ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ· Î±Î½Ï„Î»Î¯Î±Ï‚ Î¸ÎµÏÎ¼ÏŒÏ„Î·Ï„Î±Ï‚ Î³Î¹Î± 21Â°C | 
                    <span style="color: #ff8c00; font-weight: bold;">Î Î¿ÏÏ„Î¿ÎºÎ±Î»Î¯:</span> ÎœÎ·Î½Î¹Î±Î¯Î± Î·Î»Î¹Î±ÎºÎ® Ï€Î±ÏÎ±Î³Ï‰Î³Î® | 
                    <span style="color: #28a745; font-weight: bold;">Î ÏÎ¬ÏƒÎ¹Î½Î¿:</span> Î•Î½Î­ÏÎ³ÎµÎ¹Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î· ÏƒÎµ Î¼Ï€Î±Ï„Î±ÏÎ¯ÎµÏ‚ | 
                    <span style="color: #dc3545; font-weight: bold;">ÎšÏŒÎºÎºÎ¹Î½Î¿:</span> Î•Î½Î­ÏÎ³ÎµÎ¹Î± Î±Ï€ÏŒ Î´Î¯ÎºÏ„Ï…Î¿ Î”Î•Î—
                </div>
            `;
            
            content.innerHTML = tableHTML;
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Close on background click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });

        } catch (error) {
            console.error('Error in energy analysis:', error);
            alert('Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î·Î½ Î±Î½Î¬Î»Ï…ÏƒÎ· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚: ' + error.message);
        }
    }

    window.onload = function() {
        updateBatteryOptions();
        updateAll();
    };
</script>
```

</body>
</html>